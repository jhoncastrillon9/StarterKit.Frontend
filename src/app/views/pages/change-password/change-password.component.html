<div class="auth-page-container">
  <div class="auth-card-wrapper">
    <!-- Logo Section -->
    <div class="auth-logo-section">
      <img
        src="../../../../assets/img/logos/logocotiza.png"
        alt="Logo Cotiza"
        class="auth-logo"
      />
    </div>

    <!-- Auth Card -->
    <div class="auth-card">
      <div class="auth-card-header">
        <div class="auth-icon">
          <svg cIcon name="cilLockLocked"></svg>
        </div>
        <h1 class="auth-title">Cambiar Contraseña</h1>
        <p class="auth-subtitle">Crea una nueva contraseña segura para tu cuenta</p>
      </div>

      <div class="auth-card-body">
        <form [formGroup]="registerForm" (ngSubmit)="onChangePassword()">
          <!-- New Password Field -->
          <div class="auth-form-group">
            <label class="auth-label">
              Nueva Contraseña
              <span class="required-star">*</span>
            </label>
            <div class="auth-input-wrapper icon-left">
              <input
                type="password"
                class="auth-input"
                formControlName="password"
                placeholder="Ingresa tu nueva contraseña"
                autocomplete="new-password"
                [ngClass]="{'is-invalid': registerForm.get('password')?.errors?.['required'] && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty)}"
              />
              <span class="auth-input-icon">
                <svg cIcon name="cilLockLocked"></svg>
              </span>
            </div>
            <div
              *ngIf="registerForm.get('password')?.errors?.['required'] && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty)"
              class="auth-error-message"
            >
              <svg cIcon name="cilWarning"></svg>
              La contraseña es obligatoria.
            </div>
          </div>

          <!-- Confirm Password Field -->
          <div class="auth-form-group">
            <label class="auth-label">
              Confirmar Contraseña
              <span class="required-star">*</span>
            </label>
            <div class="auth-input-wrapper icon-left">
              <input
                type="password"
                class="auth-input"
                formControlName="passwordconfirmation"
                placeholder="Repite tu nueva contraseña"
                autocomplete="new-password"
                [ngClass]="{'is-invalid': registerForm.get('passwordconfirmation')?.invalid && (registerForm.get('passwordconfirmation')?.touched || registerForm.get('passwordconfirmation')?.dirty)}"
              />
              <span class="auth-input-icon">
                <svg cIcon name="cilLockUnlocked"></svg>
              </span>
            </div>
            <div
              *ngIf="registerForm.get('passwordconfirmation')?.invalid && (registerForm.get('passwordconfirmation')?.touched || registerForm.get('passwordconfirmation')?.dirty)"
              class="auth-error-message"
            >
              <svg cIcon name="cilWarning"></svg>
              Las contraseñas no coinciden.
            </div>
          </div>

          <!-- Buttons -->
          <div class="auth-buttons-row">
            <button type="button" class="auth-btn-secondary" routerLink="/login">
              <svg cIcon name="cilArrowLeft" class="me-2"></svg>
              Regresar
            </button>
            <button type="submit" class="auth-btn-primary">
              <svg cIcon name="cilCheckCircle" class="me-2"></svg>
              Cambiar Contraseña
            </button>
          </div>
        </form>
      </div>

      <div class="auth-card-footer">
        <p class="auth-footer-text">
          ¿Necesitas ayuda? <a routerLink="/login">Contáctanos</a>
        </p>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<c-modal id="liveDemoModal" [visible]="visible" (visibleChange)="handleLiveDemoChange($event)">
  <c-modal-header>
    <h5 cModalTitle>
      <svg cIcon name="cilWarning" class="me-2 text-warning"></svg>
      ¡Ups! Algo salió mal
    </h5>
    <button (click)="toggleLiveDemo()" cButtonClose></button>
  </c-modal-header>
  <c-modal-body>
    <div class="text-center py-3">
      <div class="auth-icon mx-auto mb-3" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); width: 60px; height: 60px;">
        <svg cIcon name="cilX" style="color: white;"></svg>
      </div>
      <p class="mb-0">{{messageModal}}</p>
    </div>
  </c-modal-body>
  <c-modal-footer>
    <button (click)="toggleLiveDemo()" cButton class="auth-btn-primary" style="width: auto; padding: 0.5rem 1.5rem;">
      Cerrar
    </button>    
  </c-modal-footer>
</c-modal>

<ngx-spinner 
  bdColor="rgba(0, 0, 0, 0.8)" 
  size="medium" 
  color="#fff" 
  type="ball-clip-rotate-multiple" 
  [fullScreen]="true">
  <p style="color: white; margin-top: 1rem;">Cargando...</p>
</ngx-spinner>